---
- name: Ping Servers
  hosts: service_with_postrges
  tasks:
    - name: Ping servers
      ping:

- name: GIT
  hosts: service_with_postrges
  tasks:
    - name: "Git clone repo"
      git:
        repo: https://github.com/JackSpades17/service_with_postgres
        dest: "/home/{{ ansible_user }}/service_with_postgres"
        clone: yes
        update: yes

- name: Download Postgre
  hosts: service_with_postrges
  tasks:
    - name: "Download Postgre N1"
      shell: 
        cmd: "wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -"

    - name: "Download Postgre N2"
      shell: 
        cmd: sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt/ `lsb_release -cs`-pgdg main" >> /etc/apt/sources.list.d/pgdg.list'

    - name: "Check/Install postgresql"
      apt: 
        name: "postgresql"
        state: present
        update_cache: true
      become: true

    - name: "Check/Install postgresql-contrib"
      apt: 
        name: "postgresql-contrib"
        state: present
        update_cache: true
      become: true
